<div class="profile-wrapper" *ngIf="user">

  <!-- COVER SECTION -->
  <div class="cover-section">
    <div class="cover-bg"></div>

    <div class="profile-header">

      <!-- Profile Image -->
      <img *ngIf="user?.profilePictureUrl"
           [src]="user?.profilePictureUrl"
           class="profile-img" />

      <!-- Profile Info -->
      <div class="profile-info">

        <div class="name-row">
          <h2>{{ user?.name || user?.username }}</h2>

          <!-- Follow Button (Right Side) -->
          <div *ngIf="!isOwnProfile()" class="follow-section">
            <button *ngIf="!isFollowing"
                    class="follow-btn"
                    (click)="followUser()">
              Follow
            </button>

            <button *ngIf="isFollowing"
                    class="following-btn"
                    (click)="unfollowUser()">
              Following
            </button>
          </div>
        </div>

        <p class="headline">
          {{ user?.bio || 'No headline added' }}
        </p>

        <p class="location">
          {{ user?.location || 'Location not added' }}
        </p>

        <!-- Stats -->
        <div class="stats">
          <span class="clickable"
                (click)="showFollowersModal = true">
            <strong>{{ followersCount || 0 }}</strong> Followers
          </span>

          <span class="clickable"
                (click)="showFollowingModal = true">
            <strong>{{ followingCount || 0 }}</strong> Following
          </span>
        </div>

      </div>
    </div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button [class.active]="activeTab === 'about'"
            (click)="activeTab = 'about'">About</button>

    <button [class.active]="activeTab === 'posts'"
            (click)="activeTab = 'posts'">Posts</button>

    <button *ngIf="isOwnProfile()"
            [class.active]="activeTab === 'edit'"
            (click)="activeTab = 'edit'">Edit</button>
  </div>

  <!-- TAB CONTENT -->
  <div class="tab-content">

    <!-- ABOUT -->
    <div *ngIf="activeTab === 'about'">
      <p><strong>Email:</strong> {{ user?.email }}</p>
      <p><strong>Website:</strong> {{ user?.website || 'Not added' }}</p>
      <p><strong>Role:</strong> {{ user?.roles }}</p>
    </div>

    <!-- POSTS -->
    <div *ngIf="activeTab === 'posts'">
      <div class="post-card" *ngFor="let post of posts">
        <p>{{ post.content }}</p>
        <small>{{ post.createdAt | date:'medium' }}</small>
      </div>
    </div>

    <!-- EDIT -->
    <div *ngIf="activeTab === 'edit'">

      <input [(ngModel)]="user.name" placeholder="Name" />
      <input [(ngModel)]="user.bio" placeholder="Headline" />
      <input [(ngModel)]="user.location" placeholder="Location" />
      <input [(ngModel)]="user.website" placeholder="Website" />
      <input [(ngModel)]="user.profilePictureUrl" placeholder="Profile Image URL" />

      <button class="save-btn" (click)="saveProfile()">
        Save Changes
      </button>

    </div>

  </div>

</div>